@model SkyExams.ViewModels.planeVM
@{
    ViewBag.Title = "generatePlaneReport";
    var uID = ViewData["userID"];
    var name = ViewData["userName"];
    var time = ViewData["time"];
}

<h2>Generate Plane Report</h2>
<br />
<dl class="dl-horizontal" id="report">
    <dd class="col-md-4">
        <h3>Plane Report</h3>
        <br />
        <br />
    </dd>

    <dd>
        Generated By: @name
    </dd>

    <dd class="col-md-4">
        <b>@Html.Label("Plane Type:")</b>
    </dd>

    <dd>
        @Model.Type_Description
    </dd>

    <dd class="col-md-4">
        <b>@Html.Label("Hours Flown:")</b>
    </dd>

    <dd>
        @Model.planeHours
    </dd>

    <dd class="col-md-4">
        <b>@Html.Label("Call Sign:")</b>
    </dd>

    <dd>
        @Model.Call_Sign
    </dd>

    <dd class="col-md-4">
        <b>@Html.Label("Description:")</b>
    </dd>

    <dd>
        @Model.Description
    </dd>

    <dd class="col-md-4">
        <b>@Html.Label("Services:")</b>
    </dd>
    <br />
    <br />
    <dd>
        @foreach (var item in Model.services)
        {
        <ul>
            <li>
                @Html.DisplayFor(modelItem => item.Reason_For_Service)
            </li>
            <li>
                @Html.DisplayFor(modelItem => item.Parts_Used)
            </li>
            <li>
                @Html.DisplayFor(modelItem => item.Last_Service_Date)
            </li>
        </ul>
        }
    </dd>
    <img src="~/Content/SkyExamsEdited-removebg-preview (1).png" width="150px" height="75px" title="title" alt="additional title" />
    <img src="~/Content/fts_logo.jpeg" width="150px" height="50px" title="title" alt="additional title" />
    <br />
    @DateTime.Now.Year / @DateTime.Now.Month / @DateTime.Now.Day
</dl>
<button type="button" class="btn btn-info" onclick="location.href='@Url.Action("planeReport", "Reports", new { id = uID })'">
    Back
</button>
<button type="button" class="btn btn-primary" id="generate">
    Download Report
</button>

@section planeReportScript
{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <script>
        function timer() {
            window.location.href = '/Sys_User/loginScreen';
        }
        window.oninput = setTimeout(timer, 300000);
        $('#generate').on('click', function () {
            var pdf = new jsPDF('p', 'pt', 'letter');
            source = $('#report')[0];


            specialElementHandlers = {

            };
            margins = {
                top: 80,
                bottom: 60,
                left: 40,
                width: 522
            };

            pdf.fromHTML(
                source,
                margins.left,
                margins.top, {
                'width': margins.width,
                'elementHandlers': specialElementHandlers
            },


                function (dispose) {
                    pdf.save('planeReport.pdf');
                }, margins
            );
        });
        function timer() {
        window.location.href = '/Sys_User/loginScreen';
    }
    window.oninput = setTimeout(timer, @time);
    </script>
}


